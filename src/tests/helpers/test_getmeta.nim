import
    ../../updater/updater

discard """ """
let
  html = """<html><head><meta http-equiv="content-type" content="text/html; charset=windows-1252"><title>nixos-22.11-small release nixos-22.11.740.7a6a010c3a1</title></head><body><h1>nixos-22.11-small release nixos-22.11.740.7a6a010c3a1</h1><p>Released on 2022-12-09 11:35:15 from <a href="https://github.com/NixOS/nixpkgs/commits/7a6a010c3a1d00f8470a5ca888f2f927f1860a19">Git commit <tt>7a6a010c3a1d00f8470a5ca888f2f927f1860a19</tt></a> via <a href="https://hydra.nixos.org/eval/1787172">Hydra evaluation 1787172</a>.</p><table><thead><tr><th>File name</th><th>Size</th><th>SHA-256 hash</th></tr></thead><tbody><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/binary-cache-url">binary-cache-url</a></td><td align="right">23</td><td><tt>eb8d2a51d85521c07092ed8126df19bb6f9d7c16a5275395a0e110868a4ac6c0</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/git-revision">git-revision</a></td><td align="right">40</td><td><tt>a1a32fbf326a730ce581e797a8ce78a013876b65104b69d8904ec31f37c6f105</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/nixexprs.tar.xz">nixexprs.tar.xz</a></td><td align="right">23474668</td><td><tt>1a4947287bce87a5e6fc1e681673e93d2ca22eaeed9672da85038926305e37cf</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/nixos-minimal-22.11.740.7a6a010c3a1-aarch64-linux.iso">nixos-minimal-22.11.740.7a6a010c3a1-aarch64-linux.iso</a></td><td align="right">882890752</td><td><tt>58bf5ebaabb2349fd0058ffa551340255fe9875604d472fd7d9fd75b2f21ddba</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/nixos-minimal-22.11.740.7a6a010c3a1-x86_64-linux.iso">nixos-minimal-22.11.740.7a6a010c3a1-x86_64-linux.iso</a></td><td align="right">867172352</td><td><tt>2c5abbfeb0cb5700aa55efab1f62e7b37c4ff17893477f32b191a5d98677ae32</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/options.json.br">options.json.br</a></td><td align="right">695446</td><td><tt>7b1fee6540ef896e3a6ea7f77ccf559b1c562c5e95f58cf58c56b96fccc7928a</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/packages.json.br">packages.json.br</a></td><td align="right">4538523</td><td><tt>950030eb2c2f83eae8fb380f35c4b706524d65bdb9bcd5dd9f04a7d186a53477</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/src-url">src-url</a></td><td align="right">36</td><td><tt>1d75588d569a0e9191dfb2e66c11ef75b3a0e7bd4b0114dbffdba5e79ffa5a67</tt></td></tr><tr><td><a href="https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/store-paths.xz">store-paths.xz</a></td><td align="right">4008</td><td><tt>bf75b4fbd88a6054fc50b66da23d51c7ba224b41fba346c967bd4d4ecd22a4c8</tt></td></tr></tbody></table></body></html>"""
  parsed = getMetadata(html)
assert parsed of SqliteInfo
assert parsed.name == "nixos-22.11.740.7a6a010c3a1"
assert parsed.url == "https://releases.nixos.org/nixos/22.11-small/nixos-22.11.740.7a6a010c3a1/nixexprs.tar.xz"
assert parsed.rev == "7a6a010c3a1d00f8470a5ca888f2f927f1860a19"
assert parsed.nixexprs_hash == "1a4947287bce87a5e6fc1e681673e93d2ca22eaeed9672da85038926305e37cf"
assert parsed.hash == ""
